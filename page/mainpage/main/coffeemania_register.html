

<div id="mainpage">
    <div style="display: flex;">
        <p>아이디</p>
        <input id="email_input">
        <button onclick="join_pass_email()">
            이메일 가입 여부 확인 하기
        </button>
        <p id="email_input_check"></p>
    </div>
    <div style="display: flex;">
        <p>비밀번호</p>
        <input id="pw_input">
        <button onclick="join_pass_password()">
            비밀번호 사용 가능 여부 확인 하기
        </button>
    </div>
    <div>
        <button onclick="join_pass()">
            가입 하기
        </button>
    </div>
    <script>
        function join_pass_email(){
            console.log('이메일 가입 가능 여부 확인 클릭 이벤트');
            const email_wrap = document.getElementById('email_input'); // ID가 'email_input'인 요소를 찾음
            const input_email = email_wrap.value; // email 입력 필드의 값을 가져옴
            console.log(input_email+"@coffeemanias.com"); // 콘솔에 이메일과 비밀번호를 출력
            
            if(input_email != ""){
                fetch('/email_pass', {
                method: 'POST', // POST 요청을 사용
                headers: {'Content-Type': 'application/json' // 요청의 본문이 JSON 형태임을 명시
                },
                body: JSON.stringify({
                    email: input_email+"@coffeemanias.com", // 이메일 데이터
                })
                })
                .then(response => response.json()) // 서버로부터의 응답을 JSON 형태로 파싱
                .then(data => {
                    if (data.message == "이미 존재 하는 이메일 입니다.") {
                        console.log(data.message);
                        alert(data.message);
                        document.getElementById("email_input_check").textContent = data.message;
                    }
                    if (data.message == "사용 가능한 이메일입니다.") {
                        console.log(data.message);
                        alert(data.message);
                        document.getElementById("email_input_check").textContent =data.message;
                    }
                    
                })
                .catch(error => console.error('Error:', error)); // 에러가 발생한 경우 콘솔에 에러를 출력
            }
            else{
                alert("사용하실 이메일을 입력해 주세요");
            }
        }
        function join_pass_password(){
            const pw_wrap = document.getElementById('pw_input'); // ID가 'email_input'인 요소를 찾음
            console.log(pw_wrap.value);
            alert("비밀번호는 8자 이상입니다.");
        }
        function join_pass(){
            const email_wrap = document.getElementById('email_input'); // ID가 'email_input'인 요소를 찾음
            const input_email = email_wrap.value; // email 입력 필드의 값을 가져옴
            const pw_wrap = document.getElementById('pw_input').value; // ID가 'email_input'인 요소를 찾음
            console.log(pw_wrap);
            if(pw_wrap.length < 8){
                console.log("비밀번호는 8자 이상입니다.");
                alert("비밀번호는 8자 이상입니다.");
            }
            if(document.getElementById('email_input_check').textContent == "이미 존재 하는 이메일 입니다."){
                alert("비밀번호는 8자 이상입니다.");
            }
            else{
                fetch('/join_pass', {
                method: 'POST', // POST 요청을 사용
                headers: {'Content-Type': 'application/json' // 요청의 본문이 JSON 형태임을 명시
                },
                body: JSON.stringify({
                    email: input_email+"@coffeemanias.com", // 이메일 데이터
                    password : pw_wrap
                })
                })
                .then(response => response.json()) // 서버로부터의 응답을 JSON 형태로 파싱
                .then(data => {
                    if (data.message == "이미 존재 하는 이메일 입니다.") {
                        console.log(data.message);
                        alert(data.message);
                        
                    }
                    if (data.message == "사용 가능한 이메일입니다.") {
                        console.log(data.message);
                        alert(data.message);
                        
                    }
                    
                })
            }

            
        }
    </script>
</div>
